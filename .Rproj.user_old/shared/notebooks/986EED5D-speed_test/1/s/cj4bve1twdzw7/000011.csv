"0","pos_old <- function(posterior_df){"
"0","  posterior_df %>% "
"0","          group_by(theta) %>%"
"0","          summarise(log_posterior = matrixStats::logSumExp(log_posterior)) %>%"
"0","          mutate(posterior = exp(log_posterior))"
"0","}"
"0",""
"0","pos_new <- function(posterior_df, tibble = TRUE){"
"0","  pos_new <- setNames(aggregate(posterior_df$log_posterior,             # Sum by group"
"0","          by = list(posterior_df$theta),"
"0","          FUN = matrixStats::logSumExp), "
"0","         c(""theta"", ""log_posterior""))"
"0",""
"0","  pos_new$posterior <- exp(pos_new$log_posterior)"
"0","  if(tibble){"
"0","    return (as_tibble(pos_new))"
"0","  }"
"0","  return(pos_new)"
"0","}"
"0",""
"0","bm <- bench::mark("
"0","   pos_old(posterior_df),"
"0","   pos_new(posterior_df, TRUE), "
"0","   pos_new(posterior_df, FALSE),"
"0","   check = FALSE#because df difference "
"0",")"
"0","ggplot2::autoplot(bm)"
"0",""
