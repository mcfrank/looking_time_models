"0",""
"0",""
"0",""
"0",""
"0","make_possible_scenario <- function(observation_df, "
"0","                                                scenario){"
"0","  "
"0","  alternative_df <- observation_df"
"0","  last_observation <- observation_df %>%"
"0","    # get the last row"
"0","    filter(row_number()==n())"
"0","  "
"0","  if (scenario == ""same""){"
"0","    new_observation <- last_observation %>% "
"0","      # the trial number will be wrong as we are switching but maybe we don't need to track it here in the end "
"0","      mutate(t = t + 1, "
"0","             trial_number = last_observation$trial_number, "
"0","             trial_type = last_observation$trial_type)"
"0","    "
"0","    same_observation_df <- bind_rows(alternative_df, "
"0","                              new_observation)"
"0","    "
"0","    return(same_observation_df)"
"0","    "
"0","  }else{"
"0","    "
"0","    new_observation <- as.logical(1 - (last_observation %>% "
"0","                                    select(starts_with(""V"")) %>% "
"0","                                    as.logical())) %>% "
"0","                      as.vector() %>% "
"0","                      as_tibble_row(.name_repair = ~ names(last_observation %>% select(starts_with(""V"")))) %>% "
"0","                      mutate(t = t + 1, "
"0","                             trial_number = last_observation$trial_number, "
"0","                             trial_type = last_observation$trial_type"
"0","                             )"
"0","    "
"0","    diff_observation_df <- bind_rows(alternative_df, "
"0","                              new_observation)"
"0","    "
"0","    return(diff_observation_df)"
"0","      "
"0","    "
"0","  }"
"0","  "
"0","  }"
